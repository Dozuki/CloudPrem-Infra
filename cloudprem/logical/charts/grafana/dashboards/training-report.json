{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "default",
        "enable": true,
        "hide": true,
        "iconColor": "#e24d42",
        "limit": 100,
        "name": "Annotations & Alerts",
        "rawQuery": "SELECT\n    UNIX_TIMESTAMP(<time_column>) as time_sec,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM <table name>\n  WHERE $__timeFilter(time_column)\n  ORDER BY <time_column> ASC\n  LIMIT 100\n  ",
        "showIn": 0,
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "iteration": 1591850913814,
  "links": [],
  "panels": [
    {
      "content": "# Training Report\nA snapshot of your team's competence",
      "gridPos": {
        "h": 3,
        "w": 14,
        "x": 0,
        "y": 0
      },
      "id": 4,
      "links": [],
      "mode": "markdown",
      "options": {},
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 3
      },
      "id": 14,
      "panels": [],
      "title": "",
      "type": "row"
    },
    {
      "content": "<h2>Current Release Version Details</h2>\nSelect a Guide Name for information about its most recent release",
      "gridPos": {
        "h": 3,
        "w": 24,
        "x": 0,
        "y": 4
      },
      "id": 21,
      "links": [],
      "mode": "html",
      "options": {},
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "columns": [],
      "datasource": "$GUIDE_DB",
      "description": "Guides with no existing releases will display as empty rows.",
      "fontSize": "100%",
      "gridPos": {
        "h": 3,
        "w": 24,
        "x": 0,
        "y": 7
      },
      "id": 12,
      "links": [],
      "options": {},
      "pageSize": null,
      "repeat": null,
      "scroll": true,
      "showHeader": true,
      "sort": {
        "col": 3,
        "desc": true
      },
      "styles": [
        {
          "alias": "Time",
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "pattern": "Time",
          "type": "date"
        },
        {
          "alias": "Guide ID",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "guideid",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "Release Version",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "title",
          "thresholds": [],
          "type": "string",
          "unit": "short",
          "valueMaps": []
        },
        {
          "alias": "Release On",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "MMMM D, YYYY LT",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "released_on",
          "thresholds": [],
          "type": "date",
          "unit": "short"
        },
        {
          "alias": "Release Type",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "type",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "Notes",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "notes",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "decimals": 2,
          "pattern": "/.*/",
          "thresholds": [],
          "type": "number",
          "unit": "short"
        }
      ],
      "targets": [
        {
          "alias": "",
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select gt.guideid, gt.title as \"Guide Title\", gm.device as \"Category\", r.title, from_unixtime(r.release_date) as released_on, r.type, r.notes\n\nFROM (select * FROM releases where doctype='GUIDE' and $GUIDE_ID=docid and released = 1 and status != \"removed\" ) r\n\nLEFT JOIN guide_revisions gr ON gr.guide_revisionid = r.revisionid\n\nLEFT JOIN approval_requests ar on r.releaseid = ar.releaseid\n\nLEFT JOIN guide_meta gm ON (gr.gtr_revisionid = gm.revisionid)\n\nLEFT JOIN guide_text gt ON (gr.gt_revisionid = gt.gt_revisionid)\n\n\norder by r.releaseid desc limit 1\n\n\n;\n",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "",
      "transform": "table",
      "transparent": true,
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 10
      },
      "id": 6,
      "panels": [],
      "title": "",
      "type": "row"
    },
    {
      "content": "<h2>Current Release Training Status</h2>\nView the most recently completed training for each user or guide.\n<hr>",
      "gridPos": {
        "h": 3,
        "w": 24,
        "x": 0,
        "y": 11
      },
      "id": 22,
      "links": [],
      "mode": "html",
      "options": {},
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "columns": [],
      "datasource": "$GUIDE_DB",
      "fontSize": "100%",
      "gridPos": {
        "h": 22,
        "w": 24,
        "x": 0,
        "y": 14
      },
      "id": 18,
      "links": [],
      "options": {},
      "pageSize": 20,
      "scroll": false,
      "showHeader": true,
      "sort": {
        "col": 7,
        "desc": true
      },
      "styles": [
        {
          "alias": "",
          "colorMode": "cell",
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Training Status",
          "preserveFormat": true,
          "sanitize": true,
          "thresholds": [
            "1",
            "2"
          ],
          "type": "string",
          "unit": "none",
          "valueMaps": [
            {
              "text": "Untrained",
              "value": "0"
            },
            {
              "text": "Not Current",
              "value": "1"
            },
            {
              "text": "Current",
              "value": "2"
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Release Date",
          "thresholds": [],
          "type": "date",
          "unit": "short"
        },
        {
          "alias": "Guide ID",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 0,
          "mappingType": 1,
          "pattern": "guideid",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        },
        {
          "alias": "Completed On",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "wl_endtime",
          "thresholds": [],
          "type": "date",
          "unit": "short"
        },
        {
          "alias": "Guide Title",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "link": true,
          "linkTooltip": "https://$SITE_NAME.dozuki.com/guide/${__cell:raw}/${__cell_1:raw}",
          "linkUrl": "https://$SITE_NAME.dozuki.com/guide/${__cell:raw}/${__cell_1:raw}",
          "mappingType": 1,
          "pattern": "title",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "User Name",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "username",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "User Email",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "login",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "Release Status",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "released",
          "thresholds": [],
          "type": "string",
          "unit": "short",
          "valueMaps": [
            {
              "text": "Released",
              "value": "1"
            },
            {
              "text": "Not Released",
              "value": "null"
            },
            {
              "text": "Not Released",
              "value": "0"
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Release Type",
          "thresholds": [],
          "type": "string",
          "unit": "short",
          "valueMaps": [
            {
              "text": "",
              "value": ""
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "decimals": 0,
          "pattern": "/.*/",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        }
      ],
      "targets": [
        {
          "alias": "",
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select \ncase\nwhen r.releaseid=nrv.newest_releaseid\nthen \"2\"\nElse \"1\"\nEND\nas \"Training Status\",\n\nwl.guideid, gt.title, gu.username,\n\nCONVERT_TZ(from_unixtime(wl.endtime), @@session.time_zone, '+00:00') as wl_endtime,\n\ncase\nwhen r.title is not null\nthen r.title\nelse\n\"No Release\"\nend as 'Release Version', \n\ncase\nwhen r.release_date is not null\nthen CONVERT_TZ(from_unixtime(r.release_date), @@session.time_zone, '+00:00')\nelse\nnull\nend as 'Release Date', \n\ncase\nwhen r.status is not null\nthen r.status\nelse\n\"No Release\"\nend as 'Release Status', \n \n\ncase\nwhen r.type is not null and  r.type !=\"\"\nthen r.type\nwhen r.type =\"\"\nthen \"No Type\"\nelse\n\"No Release\"\nend as 'Release Type', \n\ngu.login \n\n-- * \nfrom (select * from work_log \nwhere endtime is not null\nAND cancelled != 1\nand ($USERID = 'All Users' OR work_log.userid = $USERID)\nand ($GUIDE_ID = 'All Guides' OR work_log.guideid = $GUIDE_ID)\nand FROM_UNIXTIME(endtime) >= $__timeFrom()\nand FROM_UNIXTIME(endtime) <= $__timeTo()\nand ($TEAM = 'All Teams' or work_log.userid in (select userid from user_teams where user_teams.teamid=$TEAM))\n) wl \n\ninner join \n(select max(endtime) as last_completion, userid, guideid from work_log \nwhere endtime is not null\nAND cancelled != 1\nand ($USERID = 'All Users' OR work_log.userid = $USERID)\nand ($GUIDE_ID = 'All Guides' OR work_log.guideid = $GUIDE_ID)\nand FROM_UNIXTIME(endtime) >= $__timeFrom()\nand FROM_UNIXTIME(endtime) <= $__timeTo()\n\n\ngroup by userid, guideid) recent_completions on recent_completions.userid=wl.userid and recent_completions.guideid=wl.guideid and recent_completions.last_completion=wl.endtime\n\n\n\nleft join (select userid, username, login from global_users) gu on gu.userid=wl.userid\nLEFT JOIN (select releaseid, revisionid as guide_revisionid, release_date, type, title, status from releases where doctype='GUIDE') r on wl.guide_revisionid = r.guide_revisionid\nleft join (select docid as guideid,  max(releaseid) as newest_releaseid from releases WHERE doctype='GUIDE' and released = 1 group by guideid) nrv on wl.guideid=nrv.guideid\nleft join (select guideid, guide_revisionid from guide_current) gc on gc.guideid=wl.guideid\nleft join (select guide_revisionid, gt_revisionid, gtr_revisionid from guide_revisions) gr on gr.guide_revisionid=gc.guide_revisionid\nleft join (select gt_revisionid, title from guide_text) gt on gt.gt_revisionid=gr.gt_revisionid\nleft join (select guideid, revisionid, device from guide_meta) gm on gr.gtr_revisionid=gm.revisionid\n\n\n\nwhere \n\n($CATEGORYID = 'All Categories' OR gm.device = $CATEGORYID)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "",
      "transform": "table",
      "transparent": true,
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 36
      },
      "id": 20,
      "panels": [],
      "title": "",
      "type": "row"
    },
    {
      "content": "<h2>User Training History</h2>\nView all recorded trainings\n<hr>",
      "gridPos": {
        "h": 3,
        "w": 24,
        "x": 0,
        "y": 37
      },
      "id": 23,
      "links": [],
      "mode": "html",
      "options": {},
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "columns": [],
      "datasource": "$GUIDE_DB",
      "fontSize": "100%",
      "gridPos": {
        "h": 22,
        "w": 24,
        "x": 0,
        "y": 40
      },
      "id": 24,
      "links": [],
      "options": {},
      "pageSize": 20,
      "scroll": false,
      "showHeader": true,
      "sort": {
        "col": 7,
        "desc": true
      },
      "styles": [
        {
          "alias": "",
          "colorMode": "cell",
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Training Status",
          "preserveFormat": true,
          "sanitize": true,
          "thresholds": [
            "1",
            "2"
          ],
          "type": "string",
          "unit": "none",
          "valueMaps": [
            {
              "text": "Untrained",
              "value": "0"
            },
            {
              "text": "Not Current",
              "value": "1"
            },
            {
              "text": "Current",
              "value": "2"
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Release Date",
          "thresholds": [],
          "type": "date",
          "unit": "short"
        },
        {
          "alias": "Guide ID",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 0,
          "mappingType": 1,
          "pattern": "guideid",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        },
        {
          "alias": "Completed On",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "wl_endtime",
          "thresholds": [],
          "type": "date",
          "unit": "short"
        },
        {
          "alias": "Guide Title",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "link": true,
          "linkTooltip": "https://$SITE_NAME.dozuki.com/guide/${__cell:raw}/${__cell_1:raw}",
          "linkUrl": "https://$SITE_NAME.dozuki.com/guide/${__cell:raw}/${__cell_1:raw}",
          "mappingType": 1,
          "pattern": "title",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "User Name",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "username",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "User Email",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "login",
          "thresholds": [],
          "type": "string",
          "unit": "short"
        },
        {
          "alias": "Release Status",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "released",
          "thresholds": [],
          "type": "string",
          "unit": "short",
          "valueMaps": [
            {
              "text": "Released",
              "value": "1"
            },
            {
              "text": "Not Released",
              "value": "null"
            },
            {
              "text": "Not Released",
              "value": "0"
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "dateFormat": "YYYY-MM-DD HH:mm:ss",
          "decimals": 2,
          "mappingType": 1,
          "pattern": "Release Type",
          "thresholds": [],
          "type": "string",
          "unit": "short",
          "valueMaps": [
            {
              "text": "No Type",
              "value": "0"
            },
            {
              "text": "No Type",
              "value": "null"
            },
            {
              "text": "No Type",
              "value": "empty"
            }
          ]
        },
        {
          "alias": "",
          "colorMode": null,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "decimals": 0,
          "pattern": "/.*/",
          "thresholds": [],
          "type": "number",
          "unit": "none"
        }
      ],
      "targets": [
        {
          "alias": "",
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select \ncase\nwhen r.releaseid=nrv.newest_releaseid\nthen \"2\"\nElse \"1\"\nEND\nas \"Training Status\",\n\nwl.guideid, gt.title, gu.username,\n\nCONVERT_TZ(from_unixtime(wl.endtime), @@session.time_zone, '+00:00') as wl_endtime,\n\ncase\nwhen r.title is not null\nthen r.title\nelse\n\"No Release\"\nend as 'Release Version', \n\ncase\nwhen r.release_date is not null\nthen CONVERT_TZ(from_unixtime(r.release_date), @@session.time_zone, '+00:00')\nelse\nnull\nend as 'Release Date', \n\ncase\nwhen r.status is not null\nthen r.status\nelse\n\"No Release\"\nend as 'Release Status', \n\ncase\nwhen r.type is not null and  r.type !=\"\"\nthen r.type\nwhen r.type =\"\"\nthen \"No Type\"\nelse\n\"No Release\"\nend as 'Release Type', \n\ngu.login \n\n-- * \nfrom (select * from work_log where endtime is not null\nAND cancelled != 1\nand ($USERID = 'All Users' OR work_log.userid = $USERID)\nand ($GUIDE_ID = 'All Guides' OR work_log.guideid = $GUIDE_ID)\nand FROM_UNIXTIME(endtime) >= $__timeFrom()\nand FROM_UNIXTIME(endtime) <= $__timeTo()\n\n) wl \n\nleft join (select userid, username, login from global_users) gu on gu.userid=wl.userid\nLEFT JOIN (select releaseid, revisionid as guide_revisionid, release_date, type, title, status from releases where doctype='GUIDE') r on wl.guide_revisionid = r.guide_revisionid\nleft join (select docid as guideid,  max(releaseid) as newest_releaseid from releases WHERE doctype='GUIDE' and released = 1 group by guideid) nrv on wl.guideid=nrv.guideid\nleft join (select guideid, guide_revisionid from guide_current) gc on gc.guideid=wl.guideid\nleft join (select guide_revisionid, gt_revisionid, gtr_revisionid from guide_revisions) gr on gr.guide_revisionid=gc.guide_revisionid\nleft join (select gt_revisionid, title from guide_text) gt on gt.gt_revisionid=gr.gt_revisionid\nleft join (select guideid, revisionid, device from guide_meta) gm on gr.gtr_revisionid=gm.revisionid\n\nwhere \n\n($CATEGORYID = 'All Categories' OR gm.device = $CATEGORYID)\nand ($TEAM = 'All Teams' or wl.userid in (select userid from user_teams where user_teams.teamid=$TEAM))",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "",
      "transform": "table",
      "transparent": true,
      "type": "table"
    }
  ],
  "schemaVersion": 18,
  "style": "dark",
  "tags": [
    "Worker Training",
    "Training Report"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "text": "Dozuki",
          "value": "Dozuki"
        },
        "hide": 2,
        "includeAll": false,
        "label": "Guide Database",
        "multi": false,
        "name": "GUIDE_DB",
        "options": [],
        "query": "mysql",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {
          "selected": true,
          "text": "onprem",
          "value": "onprem"
        },
        "hide": 2,
        "label": "Site Name",
        "name": "SITE_NAME",
        "options": [
          {
            "selected": true,
            "text": "onprem",
            "value": "onprem"
          }
        ],
        "query": "onprem",
        "skipUrlSync": false,
        "type": "constant"
      },
      {
        "allValue": "'All Guides'",
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": "$GUIDE_DB",
        "definition": "select guide_text.guideid AS __value,  CONCAT(guide_text.title, \" — \", \"Guide ID:\", guide_text.guideid) AS __text   from (select max(gt_revisionid) as gt_revisionid, guideid from guide_text group by guideid) x  left join guide_text on guide_text.gt_revisionid=x.gt_revisionid",
        "hide": 0,
        "includeAll": true,
        "label": "Guide",
        "multi": false,
        "name": "GUIDE_ID",
        "options": [],
        "query": "select guide_text.guideid AS __value,  CONCAT(guide_text.title, \" — \", \"Guide ID:\", guide_text.guideid) AS __text   from (select max(gt_revisionid) as gt_revisionid, guideid from guide_text group by guideid) x  left join guide_text on guide_text.gt_revisionid=x.gt_revisionid",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tags": [],
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": "'All Categories'",
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": "$GUIDE_DB",
        "definition": "select  \"All Categories\", list.title as \"Category\" from (select distinct title from wikis where wikis.namespace=\"TOPIC\") list order by 'All Categories', title ASC",
        "hide": 0,
        "includeAll": true,
        "label": "Category",
        "multi": false,
        "name": "CATEGORYID",
        "options": [],
        "query": "select  \"All Categories\", list.title as \"Category\" from (select distinct title from wikis where wikis.namespace=\"TOPIC\") list order by 'All Categories', title ASC",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tags": [],
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": "'All Teams'",
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": "$GUIDE_DB",
        "definition": " select CONCAT(name, \" — \", \"Team ID:\", teamid) AS __text, teamid AS __value FROM teams",
        "hide": 0,
        "includeAll": true,
        "label": "Team",
        "multi": false,
        "name": "TEAM",
        "options": [],
        "query": " select CONCAT(name, \" — \", \"Team ID:\", teamid) AS __text, teamid AS __value FROM teams",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tags": [],
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      },
      {
        "allValue": "'All Users'",
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": "$GUIDE_DB",
        "definition": "",
        "hide": 0,
        "includeAll": true,
        "label": "User",
        "multi": false,
        "name": "USERID",
        "options": [],
        "query": "select  CONCAT(global_users.username, \" — \", \"User ID:\", global_users.userid) AS __text, global_users.userid AS __value from global_users",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "tagValuesQuery": "",
        "tags": [],
        "tagsQuery": "",
        "type": "query",
        "useTags": false
      }
    ]
  },
  "time": {
    "from": "now-1y",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "5s",
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ],
    "time_options": [
      "5m",
      "15m",
      "1h",
      "6h",
      "12h",
      "24h",
      "2d",
      "7d",
      "30d"
    ]
  },
  "timezone": "browser",
  "title": "Training Report",
  "uid": null,
  "version": 57
}
